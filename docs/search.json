[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "YOUR PROJECT TITLE - changed",
    "section": "",
    "text": "Note\n\n\n\nInstruction\n1 Introduction index.qmd\nExplain why you chose this topic, and the questions you are interested in studying. Provide context for readers who are not familiar with the topic.\n(suggested: 1/2 page) 250-500 words\n\n\n\n1 Introduction\nHi, this is my intro\nCreating a new branch!",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Description\nData Metadata\nDataset Name\nCitywide Payroll Data (Fiscal Year)\n\n\nProvided by\nOffice of Payroll Administration (OPA)\n\n\nData Category\nCity Government\n\n\nFrequency of Updates\nAnnually\n\n\nDate Created\nOctober 31, 2015\n\n\nData Last Updated\nOctober 30, 2024\n\n\nDimensions\n6,225,611 rows and 17 columns\n\n\nEach row represents\nCity Employee Salary per Fiscal Year\n\n\nSource URL\nhttps://data.cityofnewyork.us/\nData Format\nColumn Name\nDescription\nData Type\n\n\n\n\nFiscal Year\nFiscal Year\nNumber\n\n\nPayroll Number\nPayroll Number\nNumber\n\n\nAgency Name\nThe Payroll agency that the employee works for\nText\n\n\nLast Name\nLast name of employee\nText\n\n\nFirst Name\nFirst name of employee\nText\n\n\nMid Init\nMiddle initial of employee\nText\n\n\nAgency Start Date\nDate which employee began working for their current agency\nTimestamp\n\n\nWork Location Borough\nBorough of employee's primary work location\nText\n\n\nTitle Description\nCivil service title description of the employee\nText\n\n\nLeave Status as of June 30\nStatus of employee as of the close of the relevant fiscal year: Active, Ceased, or On Leave\nText\n\n\nBase Salary\nBase Salary assigned to the employee\nNumber\n\n\nPay Basis\nLists whether the employee is paid on an hourly, per diem or annual basis\nText\n\n\nRegular Hours\nNumber of regular hours employee worked in the fiscal year\nNumber\n\n\nRegular Gross Paid\nThe amount paid to the employee for base salary during the fiscal year\nNumber\n\n\nOT Hours\nOvertime Hours worked by employee in the fiscal year\nNumber\n\n\nTotal OT Paid\nTotal overtime pay paid to the employee in the fiscal year\nNumber\n\n\nTotal Other Pay\nIncludes any compensation in addition to gross salary and overtime pay, i.e., Differentials, lump sums, uniform allowance, meal allowance, retroactive pay increases, settlement amounts, and bonus pay, if applicable.\nNumber\nImporting the data\nhttps://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e/about_data\nFrom this URL, you can click the button ‘Export’, and then select Download File-CSV format (All data 6225611 rows). This will download a file of about 840MB. Remember, we are using the data Last Updated on October 30, 2024.\n(YYYYMMDD refers to the date that you downloaded the file)\nOnce the data was downloaded, it was added to a new folder inside the repository called ‘data_source’.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis\nMissing data (NA + Blank) in the original dataset.\n\n\nCode\npayroll_data_missing &lt;- \n  payroll_data |&gt;\n  sample_n(1000) |&gt;\n  mutate(across(everything(), ~ if_else(. == \"\", NA, .)))\n\n\n\n\nCode\npayroll_data_missing |&gt; \n  # select (-agency_name_clean, -work_location_borough_clean) |&gt; \n  # sample_n(10000) |&gt;\n  vis_miss(\n    sort_miss = TRUE,\n    # cluster = TRUE,\n    show_perc_col = TRUE,\n    warn_large_data = FALSE,\n    ) + \n  ggtitle(\"Missing Values - Original Data\")+\n  theme(\n    # axis.title.x=element_blank(),\n        # axis.text.x=element_blank(),\n        # axis.ticks.x=element_blank()\n    plot.margin = margin(r = 50)\n    )\n\n\n\n\n\n\n\n\n\n\n\nCode\npayroll_data_total_summary &lt;- payroll_data |&gt;\n  summarise(across(everything(), ~ n())) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Total Count\"\n  )\n\npayroll_data_na_summary &lt;- payroll_data |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"NA\"\n  )\n\npayroll_data_blank_summary &lt;- payroll_data |&gt;\n  summarise(across(everything(), ~ sum(. == \"\", na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Blank\"\n  )\n\npayroll_data_zero_summary &lt;- payroll_data |&gt;\n  summarise(across(everything(), ~ sum(. == 0, na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Zero\"\n  )\n\n\n\n\nCode\npayroll_data_combined_summary &lt;- \n  payroll_data_total_summary |&gt; \n  inner_join(payroll_data_na_summary, by = \"Column\") |&gt; \n  inner_join(payroll_data_blank_summary, by = \"Column\") |&gt; \n  inner_join(payroll_data_zero_summary, by = \"Column\")\n\n\n\n\nCode\n# payroll_data_combined_summary\n\n\n\n\nCode\npayroll_data_combined_summary_likert &lt;-\npayroll_data_combined_summary |&gt; \n  mutate(`Present` = `Total Count` - `NA` - `Blank` - Zero) |&gt; \n  mutate(`Present` = `Present` / `Total Count`) |&gt; \n  mutate(`NA` = `NA` / `Total Count`) |&gt; \n  mutate(`Blank` = `Blank` / `Total Count`) |&gt; \n  mutate(`Zero` = Zero / `Total Count`) |&gt; \n  dplyr::select(`Column`,`NA`,`Blank`,Zero,`Present`) |&gt; \n  filter(!Column %in% c('agency_name_clean','work_location_borough_clean'))\n\n# payroll_data_combined_summary_likert\n\n\n\n\nCode\nlikert_colors &lt;- c(\"NA\" = \"#D7191C\",\n                   \"Blank\" = \"#FDAE61\",\n                   \"Zero\" = \"#ABD9E9\",\n                   \"Present\" = \"#2C7BB6\")\n\n\n\n# HH::likert(x=Column~ .,payroll_data_combined_summary_likert, \n#            positive.order=TRUE,\n#            as.percent = T,\n#            main = 'Diverging Stacked Bar',\n#            xlab='Percentage',\n#            ylab='Columns',\n#            col = likert_colors,\n#            ReferenceZero=2.5,\n#            rightAxis=FALSE\n#            )\n\n\n\n\nCode\npayroll_data_fire_police &lt;- readRDS(\"data_source/payroll_data_fire_police.rds\")\n\npayroll_data_fire_police_total_summary &lt;- payroll_data_fire_police |&gt;\n  summarise(across(everything(), ~ n())) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Total Count\"\n  )\n\npayroll_data_fire_police_na_summary &lt;- payroll_data_fire_police |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"NA\"\n  )\n\npayroll_data_fire_police_blank_summary &lt;- payroll_data_fire_police |&gt;\n  summarise(across(everything(), ~ sum(. == \"\", na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Blank\"\n  )\n\npayroll_data_fire_police_zero_summary &lt;- payroll_data_fire_police |&gt;\n  summarise(across(everything(), ~ sum(. == 0, na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Zero\"\n  )\n\n\npayroll_data_fire_police_combined_summary &lt;- \n  payroll_data_fire_police_total_summary |&gt; \n  inner_join(payroll_data_fire_police_na_summary, by = \"Column\") |&gt; \n  inner_join(payroll_data_fire_police_blank_summary, by = \"Column\") |&gt; \n  inner_join(payroll_data_fire_police_zero_summary, by = \"Column\")\n\n\npayroll_data_fire_police_combined_summary_likert &lt;-\n  payroll_data_fire_police_combined_summary |&gt; \n  mutate(`Present` = `Total Count` - `NA` - `Blank` - Zero) |&gt; \n  mutate(`Present` = `Present` / `Total Count`) |&gt; \n  mutate(`NA` = `NA` / `Total Count`) |&gt; \n  mutate(`Blank` = `Blank` / `Total Count`) |&gt; \n  mutate(`Zero` = Zero / `Total Count`) |&gt; \n  dplyr::select(`Column`,`NA`,`Blank`,Zero,`Present`) |&gt; \n  filter(!Column %in% c('agency_name_clean','work_location_borough_clean'))\n\n\n\n\nCode\npayroll_data_missing_group_likert &lt;- bind_rows(\n  payroll_data_combined_summary_likert |&gt; mutate(group= 'Original Data'), \n  payroll_data_fire_police_combined_summary_likert |&gt; mutate(group= 'Final Subset Data')\n)\n\nHH::likert(x=Column~. | group,payroll_data_missing_group_likert, \n           positive.order=TRUE,\n           as.percent = T,\n           main = 'Missing Values',\n           xlab='Percentage',\n           ylab='Columns',\n           col = likert_colors,\n           ReferenceZero=2.5,\n           rightAxis=FALSE,\n           xlimEqualLeftRight=TRUE\n           )\n\n\n\n\n\n\n\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(last_name == \"\") |&gt; \n  group_by(agency_name) |&gt; \n  summarise(`Count of Blank Records` = n()) |&gt; \n  kable(col.names = c(\"Agency\", \"Count of Blank Records\")) \n\n\n\n\n\nAgency\nCount of Blank Records\n\n\n\n\nPOLICE DEPARTMENT\n9992",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "Possible 10 Charts based on Problem Set1 hitogram / facets (ps1) boxplot jitter (ps1) with ridgeline (ps1) density lines bar chart lump facet scattter plot Density plot geom_point with facet 9x9 grid (ps2 california) Cleveland dot plot ggparcords parcoords likert mosaic alluvium 11\n\n\n\nCode\nlibrary(tidyverse)\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nCode\nlibrary(ggplot2)\n\n\n\n\nCode\npayroll_data_source &lt;- read.csv(\"./data_source/Citywide_Payroll_Data__Fiscal_Year__20241111.csv\") \npayroll_data &lt;- payroll_data_source\n\n\n\n\nCode\nnames(payroll_data)\n\n\n [1] \"Fiscal.Year\"                \"Payroll.Number\"            \n [3] \"Agency.Name\"                \"Last.Name\"                 \n [5] \"First.Name\"                 \"Mid.Init\"                  \n [7] \"Agency.Start.Date\"          \"Work.Location.Borough\"     \n [9] \"Title.Description\"          \"Leave.Status.as.of.June.30\"\n[11] \"Base.Salary\"                \"Pay.Basis\"                 \n[13] \"Regular.Hours\"              \"Regular.Gross.Paid\"        \n[15] \"OT.Hours\"                   \"Total.OT.Paid\"             \n[17] \"Total.Other.Pay\"           \n\n\n\n\nCode\npayroll_data &lt;- data.frame(payroll_data_source)\n\n\n\n\nCode\nhead(payroll_data,5)\n\n\n  Fiscal.Year Payroll.Number                    Agency.Name Last.Name\n1        2020             17 OFFICE OF EMERGENCY MANAGEMENT   BEREZIN\n2        2020             17 OFFICE OF EMERGENCY MANAGEMENT    GEAGER\n3        2020             17 OFFICE OF EMERGENCY MANAGEMENT    RAMANI\n4        2020             17 OFFICE OF EMERGENCY MANAGEMENT     ROTTA\n5        2020             17 OFFICE OF EMERGENCY MANAGEMENT WILSON II\n  First.Name Mid.Init Agency.Start.Date Work.Location.Borough\n1    MIKHAIL                 08/10/2015              BROOKLYN\n2   VERONICA        M        09/12/2016              BROOKLYN\n3   SHRADDHA                 02/22/2016              BROOKLYN\n4   JONATHAN        D        09/16/2013              BROOKLYN\n5     ROBERT        P        04/30/2018              BROOKLYN\n               Title.Description Leave.Status.as.of.June.30 Base.Salary\n1 EMERGENCY PREPAREDNESS MANAGER                     ACTIVE       86005\n2 EMERGENCY PREPAREDNESS MANAGER                     ACTIVE       86005\n3 EMERGENCY PREPAREDNESS MANAGER                     ACTIVE       86005\n4 EMERGENCY PREPAREDNESS MANAGER                     ACTIVE       86005\n5 EMERGENCY PREPAREDNESS MANAGER                     ACTIVE       86005\n  Pay.Basis Regular.Hours Regular.Gross.Paid OT.Hours Total.OT.Paid\n1 per Annum          1820           84698.21        0             0\n2 per Annum          1820           84698.21        0             0\n3 per Annum          1820           84698.21        0             0\n4 per Annum          1820           84698.21        0             0\n5 per Annum          1820           84698.21        0             0\n  Total.Other.Pay\n1               0\n2               0\n3               0\n4               0\n5               0\n\n\n\n\nCode\nprint(names(payroll_data))\n\n\n [1] \"Fiscal.Year\"                \"Payroll.Number\"            \n [3] \"Agency.Name\"                \"Last.Name\"                 \n [5] \"First.Name\"                 \"Mid.Init\"                  \n [7] \"Agency.Start.Date\"          \"Work.Location.Borough\"     \n [9] \"Title.Description\"          \"Leave.Status.as.of.June.30\"\n[11] \"Base.Salary\"                \"Pay.Basis\"                 \n[13] \"Regular.Hours\"              \"Regular.Gross.Paid\"        \n[15] \"OT.Hours\"                   \"Total.OT.Paid\"             \n[17] \"Total.Other.Pay\"           \n\n\nCode\nnames(payroll_data) &lt;- gsub(\"[\\\\.]+\", \"_\", tolower(names(payroll_data_source)))\n\nprint(names(payroll_data))\n\n\n [1] \"fiscal_year\"                \"payroll_number\"            \n [3] \"agency_name\"                \"last_name\"                 \n [5] \"first_name\"                 \"mid_init\"                  \n [7] \"agency_start_date\"          \"work_location_borough\"     \n [9] \"title_description\"          \"leave_status_as_of_june_30\"\n[11] \"base_salary\"                \"pay_basis\"                 \n[13] \"regular_hours\"              \"regular_gross_paid\"        \n[15] \"ot_hours\"                   \"total_ot_paid\"             \n[17] \"total_other_pay\"           \n\n\n\n\nCode\npayroll_data |&gt; \n  group_by(agency_name, work_location_borough) |&gt; \n  summarise(\n    Total_records = n()\n  )\n\n\n`summarise()` has grouped output by 'agency_name'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 507 × 3\n# Groups:   agency_name [170]\n   agency_name               work_location_borough Total_records\n   &lt;chr&gt;                     &lt;chr&gt;                         &lt;int&gt;\n 1 ADMIN FOR CHILDREN'S SVCS \"\"                             6627\n 2 ADMIN FOR CHILDREN'S SVCS \"BRONX\"                       14245\n 3 ADMIN FOR CHILDREN'S SVCS \"BROOKLYN\"                    15564\n 4 ADMIN FOR CHILDREN'S SVCS \"MANHATTAN\"                   40037\n 5 ADMIN FOR CHILDREN'S SVCS \"QUEENS\"                       8204\n 6 ADMIN FOR CHILDREN'S SVCS \"RICHMOND\"                     2256\n 7 ADMIN TRIALS AND HEARINGS \"\"                              632\n 8 ADMIN TRIALS AND HEARINGS \"BRONX\"                         457\n 9 ADMIN TRIALS AND HEARINGS \"BROOKLYN\"                      761\n10 ADMIN TRIALS AND HEARINGS \"MANHATTAN\"                    4527\n# ℹ 497 more rows\n\n\n\n\nCode\npayroll_data |&gt; \n  group_by(agency_name) |&gt; \n  summarise(\n    Total_records = n_distinct(work_location_borough)\n  )\n\n\n# A tibble: 170 × 2\n   agency_name                    Total_records\n   &lt;chr&gt;                                  &lt;int&gt;\n 1 ADMIN FOR CHILDREN'S SVCS                  6\n 2 ADMIN TRIALS AND HEARINGS                  6\n 3 BOARD OF CORRECTION                        2\n 4 BOARD OF CORRECTIONS                       1\n 5 BOARD OF ELECTION                          6\n 6 BOARD OF ELECTION POLL WORKERS             4\n 7 BOROUGH PRESIDENT-BRONX                    2\n 8 BOROUGH PRESIDENT-BROOKLYN                 2\n 9 BOROUGH PRESIDENT-QUEENS                   2\n10 BOROUGH PRESIDENT-STATEN IS                2\n# ℹ 160 more rows\n\n\n\n\nCode\npayroll_data |&gt; \n  group_by(agency_name) |&gt; \n  summarise(\n    Total_records = n()\n  ) \n\n\n# A tibble: 170 × 2\n   agency_name                    Total_records\n   &lt;chr&gt;                                  &lt;int&gt;\n 1 ADMIN FOR CHILDREN'S SVCS              86933\n 2 ADMIN TRIALS AND HEARINGS               7676\n 3 BOARD OF CORRECTION                      299\n 4 BOARD OF CORRECTIONS                      17\n 5 BOARD OF ELECTION                      11695\n 6 BOARD OF ELECTION POLL WORKERS        375001\n 7 BOROUGH PRESIDENT-BRONX                  714\n 8 BOROUGH PRESIDENT-BROOKLYN               912\n 9 BOROUGH PRESIDENT-QUEENS                 818\n10 BOROUGH PRESIDENT-STATEN IS              568\n# ℹ 160 more rows\n\n\n\n\nCode\npayroll_data |&gt; \n  mutate(agency_name_clean = trimws(gsub(\"#\\\\d+$\", \"\", agency_name))) |&gt; \n  group_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n()\n  ) \n\n\n# A tibble: 116 × 2\n   agency_name_clean              Total_records\n   &lt;chr&gt;                                  &lt;int&gt;\n 1 ADMIN FOR CHILDREN'S SVCS              86933\n 2 ADMIN TRIALS AND HEARINGS               7676\n 3 BOARD OF CORRECTION                      299\n 4 BOARD OF CORRECTIONS                      17\n 5 BOARD OF ELECTION                      11695\n 6 BOARD OF ELECTION POLL WORKERS        375001\n 7 BOROUGH PRESIDENT-BRONX                  714\n 8 BOROUGH PRESIDENT-BROOKLYN               912\n 9 BOROUGH PRESIDENT-QUEENS                 818\n10 BOROUGH PRESIDENT-STATEN IS              568\n# ℹ 106 more rows\n\n\n\n\nCode\npayroll_data &lt;- \n  payroll_data |&gt; \n  mutate(agency_name_clean = trimws(gsub(\"#\\\\d+$\", \"\", agency_name)))\n\n\n\n\nCode\npayroll_data |&gt; \n  # mutate(agency_name_clean = trimws(gsub(\"#\\\\d+$\", \"\", agency_name))) |&gt; \n  group_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(desc(Total_records))\n\n\n# A tibble: 116 × 2\n   agency_name_clean              Total_records\n   &lt;chr&gt;                                  &lt;int&gt;\n 1 DEPT OF ED PEDAGOGICAL               1207427\n 2 DEPT OF ED PER SESSION TEACHER        997983\n 3 POLICE DEPARTMENT                     612076\n 4 DEPT OF ED PARA PROFESSIONALS         412698\n 5 BOARD OF ELECTION POLL WORKERS        375001\n 6 DEPT OF ED HRLY SUPPORT STAFF         255501\n 7 FIRE DEPARTMENT                       209272\n 8 DEPARTMENT OF EDUCATION ADMIN         181282\n 9 DEPT OF PARKS & RECREATION            170200\n10 HRA/DEPT OF SOCIAL SERVICES           157963\n# ℹ 106 more rows\n\n\n\n\nCode\npayroll_data |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"DEPT OF ED PEDAGOGICAL\",\n    \"DEPT OF ED PER SESSION TEACHER\",\n    \"DEPT OF ED HRLY SUPPORT STAFF\",\"DEPT OF ED PARA PROFESSIONALS\",\n    \"DEPT OF ED PEDAGOGICAL\",\n    \"DEPT OF ED PER DIEM TEACHERS\", \n    \"DEPT OF ED PER SESSION TEACHER\",\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \ngroup_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n(),\n    n_work_location_borough = n_distinct(work_location_borough)\n  ) |&gt; \n  arrange(desc(Total_records))\n\n\n# A tibble: 7 × 3\n  agency_name_clean              Total_records n_work_location_borough\n  &lt;chr&gt;                                  &lt;int&gt;                   &lt;int&gt;\n1 DEPT OF ED PEDAGOGICAL                108209                       2\n2 DEPT OF ED PER SESSION TEACHER         87361                       1\n3 POLICE DEPARTMENT                      65901                       5\n4 DEPT OF ED PARA PROFESSIONALS          41305                       2\n5 DEPT OF ED HRLY SUPPORT STAFF          23545                       1\n6 FIRE DEPARTMENT                        21412                       5\n7 DEPT OF ED PER DIEM TEACHERS           16662                       1\n\n\n\n\nCode\npayroll_data |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"DEPT OF ED PEDAGOGICAL\",\n    \"DEPT OF ED PER SESSION TEACHER\",\n    \"DEPT OF ED HRLY SUPPORT STAFF\",\"DEPT OF ED PARA PROFESSIONALS\",\n    \"DEPT OF ED PEDAGOGICAL\",\n    \"DEPT OF ED PER DIEM TEACHERS\", \n    \"DEPT OF ED PER SESSION TEACHER\",\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \ngroup_by(agency_name_clean,work_location_borough) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(agency_name_clean,work_location_borough)\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 17 × 3\n# Groups:   agency_name_clean [7]\n   agency_name_clean              work_location_borough Total_records\n   &lt;chr&gt;                          &lt;chr&gt;                         &lt;int&gt;\n 1 DEPT OF ED HRLY SUPPORT STAFF  \"MANHATTAN\"                   23545\n 2 DEPT OF ED PARA PROFESSIONALS  \"\"                                1\n 3 DEPT OF ED PARA PROFESSIONALS  \"MANHATTAN\"                   41304\n 4 DEPT OF ED PEDAGOGICAL         \"MANHATTAN\"                  103920\n 5 DEPT OF ED PEDAGOGICAL         \"OTHER\"                        4289\n 6 DEPT OF ED PER DIEM TEACHERS   \"MANHATTAN\"                   16662\n 7 DEPT OF ED PER SESSION TEACHER \"MANHATTAN\"                   87361\n 8 FIRE DEPARTMENT                \"BRONX\"                        3249\n 9 FIRE DEPARTMENT                \"BROOKLYN\"                     8911\n10 FIRE DEPARTMENT                \"MANHATTAN\"                    3707\n11 FIRE DEPARTMENT                \"QUEENS\"                       4518\n12 FIRE DEPARTMENT                \"RICHMOND\"                     1027\n13 POLICE DEPARTMENT              \"BRONX\"                        6638\n14 POLICE DEPARTMENT              \"BROOKLYN\"                    12186\n15 POLICE DEPARTMENT              \"MANHATTAN\"                   34818\n16 POLICE DEPARTMENT              \"QUEENS\"                      10575\n17 POLICE DEPARTMENT              \"RICHMOND\"                     1684\n\n\n\n\nCode\npayroll_data |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \ngroup_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(agency_name_clean)\n\n\n# A tibble: 2 × 2\n  agency_name_clean Total_records\n  &lt;chr&gt;                     &lt;int&gt;\n1 FIRE DEPARTMENT          209272\n2 POLICE DEPARTMENT        612076\n\n\n\n\nCode\npayroll_data |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \ngroup_by(agency_name_clean,fiscal_year) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(agency_name_clean,fiscal_year)\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 21 × 3\n# Groups:   agency_name_clean [2]\n   agency_name_clean fiscal_year Total_records\n   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt;\n 1 FIRE DEPARTMENT          2014         16555\n 2 FIRE DEPARTMENT          2015         17380\n 3 FIRE DEPARTMENT          2016         19934\n 4 FIRE DEPARTMENT          2017         18687\n 5 FIRE DEPARTMENT          2018         18391\n 6 FIRE DEPARTMENT          2019         18679\n 7 FIRE DEPARTMENT          2020         19193\n 8 FIRE DEPARTMENT          2021         19049\n 9 FIRE DEPARTMENT          2022         20920\n10 FIRE DEPARTMENT          2023         19072\n# ℹ 11 more rows\n\n\n\n\nCode\npayroll_data_fire_police &lt;-\n  payroll_data |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) \n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  summary()\n\n\n  fiscal_year   payroll_number  agency_name         last_name        \n Min.   :2024   Min.   :56.00   Length:87313       Length:87313      \n 1st Qu.:2024   1st Qu.:56.00   Class :character   Class :character  \n Median :2024   Median :56.00   Mode  :character   Mode  :character  \n Mean   :2024   Mean   :56.25                                        \n 3rd Qu.:2024   3rd Qu.:56.00                                        \n Max.   :2024   Max.   :57.00                                        \n  first_name          mid_init         agency_start_date  work_location_borough\n Length:87313       Length:87313       Length:87313       Length:87313         \n Class :character   Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character   Mode  :character     \n                                                                               \n                                                                               \n                                                                               \n title_description  leave_status_as_of_june_30  base_salary       \n Length:87313       Length:87313               Min.   :    11.98  \n Class :character   Class :character           1st Qu.: 53790.00  \n Mode  :character   Mode  :character           Median : 91610.00  \n                                               Mean   : 82765.04  \n                                               3rd Qu.:105146.00  \n                                               Max.   :277605.00  \n  pay_basis         regular_hours  regular_gross_paid    ot_hours     \n Length:87313       Min.   :-634   Min.   :-17474     Min.   : -72.0  \n Class :character   1st Qu.:1023   1st Qu.: 32795     1st Qu.:   0.0  \n Mode  :character   Median :2080   Median : 66875     Median : 190.1  \n                    Mean   :1548   Mean   : 77730     Mean   : 249.9  \n                    3rd Qu.:2080   3rd Qu.:121729     3rd Qu.: 427.4  \n                    Max.   :2942   Max.   :289829     Max.   :2091.7  \n total_ot_paid      total_other_pay  agency_name_clean \n Min.   : -2408.3   Min.   :-29727   Length:87313      \n 1st Qu.:   949.1   1st Qu.:  3012   Class :character  \n Median : 12269.7   Median :  9846   Mode  :character  \n Mean   : 21291.7   Mean   : 14044                     \n 3rd Qu.: 34277.8   3rd Qu.: 24321                     \n Max.   :215680.3   Max.   :347513                     \n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  group_by(agency_name_clean,title_description) |&gt; \n  summarise(\n    Total_records = n()\n    ,.groups = \"drop\"\n  ) |&gt; \n  arrange(agency_name_clean,desc(Total_records))\n\n\n# A tibble: 440 × 3\n   agency_name_clean title_description                             Total_records\n   &lt;chr&gt;             &lt;chr&gt;                                                 &lt;int&gt;\n 1 FIRE DEPARTMENT   FIREFIGHTER                                            9804\n 2 FIRE DEPARTMENT   EMERGENCY MEDICAL SPECIALIST-EMT                       3968\n 3 FIRE DEPARTMENT   LIEUTENANT                                             1620\n 4 FIRE DEPARTMENT   EMERGENCY MEDICAL SPECIALIST-PARAMEDIc                 1296\n 5 FIRE DEPARTMENT   CAPTAIN                                                 727\n 6 FIRE DEPARTMENT   SUPERVISING EMERGENCY MEDICAL SERVICE SPECIA…           657\n 7 FIRE DEPARTMENT   BATTALION CHIEF                                         464\n 8 FIRE DEPARTMENT   ASSOCIATE FIRE PROTECTION INSPECTOR                     210\n 9 FIRE DEPARTMENT   FIRE PROTECTION INSPECTOR                               200\n10 FIRE DEPARTMENT   FIRE ALARM DISPATCHER                                   197\n# ℹ 430 more rows\n\n\n\n\nCode\npayroll_data_fire_police &lt;-\n  payroll_data_fire_police |&gt; \n  mutate(total_pay = rowSums(across(c(regular_gross_paid, total_ot_paid, total_other_pay)),na.rm = TRUE))\n\n\n\n\nCode\nlibrary(lubridate)\n\npayroll_data_fire_police &lt;- \n  payroll_data_fire_police |&gt; \n  mutate(agency_start_date_clean = mdy(agency_start_date))\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  select(agency_start_date, agency_start_date_clean) |&gt; \n  head()\n\n\n  agency_start_date agency_start_date_clean\n1        12/20/1998              1998-12-20\n2        04/25/2016              2016-04-25\n3        04/30/1995              1995-04-30\n4        12/16/2013              2013-12-16\n5        07/11/2012              2012-07-11\n6        07/09/2014              2014-07-09\n\n\n\n\nCode\nhead(payroll_data_fire_police)\n\n\n  fiscal_year payroll_number       agency_name last_name first_name mid_init\n1        2020             56 POLICE DEPARTMENT   MORALES       JOSE         \n2        2020             56 POLICE DEPARTMENT     BOYNE     DANIEL        G\n3        2020             56 POLICE DEPARTMENT    MURTHA      KEVIN         \n4        2020             56 POLICE DEPARTMENT MASTRANDE      JAMES        J\n5        2020             56 POLICE DEPARTMENT     AROCA       ALMA        P\n6        2020             56 POLICE DEPARTMENT     TABBS     RONALD        G\n  agency_start_date work_location_borough                 title_description\n1        12/20/1998             MANHATTAN     SUPERVISOR OF SCHOOL SECURITY\n2        04/25/2016             MANHATTAN               STATIONARY ENGINEER\n3        04/30/1995             MANHATTAN LIEUTENANT D/A SPECIAL ASSIGNMENT\n4        12/16/2013             MANHATTAN               STATIONARY ENGINEER\n5        07/11/2012             MANHATTAN                    POLICE OFFICER\n6        07/09/2014             MANHATTAN                    POLICE OFFICER\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     CEASED     57813.0 per Annum          0.00\n2                     ACTIVE       508.8   per Day       2080.00\n3                     CEASED    141196.0 per Annum        665.18\n4                     ACTIVE       508.8   per Day       2080.00\n5                     CEASED     85292.0 per Annum         22.87\n6                   ON LEAVE     85292.0 per Annum       1822.85\n  regular_gross_paid ot_hours total_ot_paid total_other_pay agency_name_clean\n1               0.00     0.00          0.00       650000.00 POLICE DEPARTMENT\n2          140146.17  1125.25     117728.07        40696.41 POLICE DEPARTMENT\n3           48008.86  2451.57     162000.47        78132.88 POLICE DEPARTMENT\n4          140146.17  1007.00     103226.97        27980.42 POLICE DEPARTMENT\n5          227914.67     0.00          0.00        30289.83 POLICE DEPARTMENT\n6          230597.55    55.27       3071.28        22856.71 POLICE DEPARTMENT\n  total_pay agency_start_date_clean\n1  650000.0              1998-12-20\n2  298570.7              2016-04-25\n3  288142.2              1995-04-30\n4  271353.6              2013-12-16\n5  258204.5              2012-07-11\n6  256525.5              2014-07-09\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  summarise(across(everything(), ~ sum(is.na(.))))\n\n\n  fiscal_year payroll_number agency_name last_name first_name mid_init\n1           0         243649           0         0          0        0\n  agency_start_date work_location_borough title_description\n1                 0                     0                 0\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                          0           0         0             0\n  regular_gross_paid ot_hours total_ot_paid total_other_pay agency_name_clean\n1                  0        0             0               0                 0\n  total_pay agency_start_date_clean\n1         0                       0\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  group_by(fiscal_year,payroll_number) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(fiscal_year,payroll_number)\n\n\n`summarise()` has grouped output by 'fiscal_year'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 18 × 3\n# Groups:   fiscal_year [11]\n   fiscal_year payroll_number Total_records\n         &lt;int&gt;          &lt;int&gt;         &lt;int&gt;\n 1        2014             57         16555\n 2        2015             NA         76644\n 3        2016             NA         85802\n 4        2017             NA         81203\n 5        2018             56         59811\n 6        2018             57         18391\n 7        2019             56         59970\n 8        2019             57         18679\n 9        2020             56         60316\n10        2020             57         19193\n11        2021             56         59009\n12        2021             57         19049\n13        2022             56         60804\n14        2022             57         20920\n15        2023             56         58617\n16        2023             57         19072\n17        2024             56         65901\n18        2024             57         21412\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  group_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n(),\n    min(agency_start_date_clean),\n    max(agency_start_date_clean)\n  ) |&gt; \n  arrange(agency_name_clean,desc(Total_records))\n\n\n# A tibble: 2 × 4\n  agency_name_clean Total_records min(agency_start_date…¹ max(agency_start_dat…²\n  &lt;chr&gt;                     &lt;int&gt; &lt;date&gt;                  &lt;date&gt;                \n1 FIRE DEPARTMENT          209272 1968-04-22              2024-07-29            \n2 POLICE DEPARTMENT        612076 1960-11-14              2049-10-16            \n# ℹ abbreviated names: ¹​`min(agency_start_date_clean)`,\n#   ²​`max(agency_start_date_clean)`\n\n\n\n\nCode\n# good for alluvium, year start, year paid\npayroll_data_fire_police |&gt; \n  mutate(year_agency_start_date_clean = year(agency_start_date_clean)) |&gt; \n  group_by(year_agency_start_date_clean) |&gt; \n  summarise(\n    Total_records = n(),\n  ) |&gt; \n  arrange(year_agency_start_date_clean)\n\n\n# A tibble: 62 × 2\n   year_agency_start_date_clean Total_records\n                          &lt;dbl&gt;         &lt;int&gt;\n 1                         1960             1\n 2                         1962             9\n 3                         1966            10\n 4                         1967             3\n 5                         1968             9\n 6                         1969            15\n 7                         1970            39\n 8                         1971            25\n 9                         1972            20\n10                         1973           162\n# ℹ 52 more rows\n\n\n\n\nCode\n# good for alluvium, year start, year paid\npayroll_data_fire_police |&gt; \n  mutate(year_agency_start_date_clean = year(agency_start_date_clean)) |&gt; \n  filter(year_agency_start_date_clean == 1960)\n\n\n  fiscal_year payroll_number       agency_name  last_name first_name mid_init\n1        2015             NA POLICE DEPARTMENT FITZGERALD       JOAN        T\n  agency_start_date work_location_borough title_description\n1        11/14/1960             MANHATTAN       STAFF NURSE\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     CEASED       79000 per Annum             0\n  regular_gross_paid ot_hours total_ot_paid total_other_pay agency_name_clean\n1           13659.74        0             0               0 POLICE DEPARTMENT\n  total_pay agency_start_date_clean year_agency_start_date_clean\n1  13659.74              1960-11-14                         1960\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  group_by(agency_name_clean,pay_basis) |&gt; \n  summarise(\n    Total_records = n(),\n    TOTAL_total_pay = sum(total_pay),\n    TOTAL_regular_gross_paid = sum(regular_gross_paid),\n    TOTAL_total_ot_paid = sum(total_ot_paid),\n    TOTAL_total_other_pay = sum(total_other_pay),\n    PCT_total_pay = sum(total_pay) / sum(total_pay),\n    PCT_regular_gross_paid = sum(regular_gross_paid)/ sum(total_pay),\n    PCT_total_ot_paid = sum(total_ot_paid)/ sum(total_pay),\n    PCT_total_other_pay = sum(total_other_pay)/ sum(total_pay),\n    records_with_1 = sum(is.na(regular_gross_paid)),\n    records_with_2 = sum(is.na(total_ot_paid)),\n    records_with_3 = sum(is.na(total_other_pay)),\n  ) |&gt; \n  arrange(agency_name_clean,pay_basis,desc(Total_records))\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 8 × 14\n# Groups:   agency_name_clean [2]\n  agency_name_clean pay_basis       Total_records TOTAL_total_pay\n  &lt;chr&gt;             &lt;chr&gt;                   &lt;int&gt;           &lt;dbl&gt;\n1 FIRE DEPARTMENT   Prorated Annual             7         228256.\n2 FIRE DEPARTMENT   per Annum               20848     2567186030.\n3 FIRE DEPARTMENT   per Day                   357       50577418.\n4 FIRE DEPARTMENT   per Hour                  200        7387331.\n5 POLICE DEPARTMENT Prorated Annual             8         317293.\n6 POLICE DEPARTMENT per Annum               62083     7122451821.\n7 POLICE DEPARTMENT per Day                   691       74276308.\n8 POLICE DEPARTMENT per Hour                 3119       49707895.\n# ℹ 10 more variables: TOTAL_regular_gross_paid &lt;dbl&gt;,\n#   TOTAL_total_ot_paid &lt;dbl&gt;, TOTAL_total_other_pay &lt;dbl&gt;,\n#   PCT_total_pay &lt;dbl&gt;, PCT_regular_gross_paid &lt;dbl&gt;, PCT_total_ot_paid &lt;dbl&gt;,\n#   PCT_total_other_pay &lt;dbl&gt;, records_with_1 &lt;int&gt;, records_with_2 &lt;int&gt;,\n#   records_with_3 &lt;int&gt;\n\n\nCode\n  # format(n=1)\n  # format(scientific=TRUE)\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year == \"2024\") |&gt;\n  filter(title_description == \"CHAPLAIN\")\n\n\n   fiscal_year payroll_number       agency_name       last_name first_name\n1         2024             56 POLICE DEPARTMENT         LIMONGI     CARLOS\n2         2024             56 POLICE DEPARTMENT      RECABARREN   JONATHAN\n3         2024             56 POLICE DEPARTMENT          KUKIQI      TAHIR\n4         2024             56 POLICE DEPARTMENT           LOPEZ    MICHAEL\n5         2024             56 POLICE DEPARTMENT           BROWN     VICTOR\n6         2024             56 POLICE DEPARTMENT      ANASTASIOU     GEORGE\n7         2024             56 POLICE DEPARTMENT WILLIAMS-HARRIS    BARBARA\n8         2024             56 POLICE DEPARTMENT          EGUINO    MICHAEL\n9         2024             56 POLICE DEPARTMENT          FRANCO     JOSEPH\n10        2024             56 POLICE DEPARTMENT         CASSATO      DAVID\n11        2024             56 POLICE DEPARTMENT            KASS      ALVIN\n12        2024             56 POLICE DEPARTMENT          ROMANO     ROBERT\n13        2024             57   FIRE DEPARTMENT       DELENDICK       JOHN\n14        2024             57   FIRE DEPARTMENT     GIGANTIELLO      JAMIE\n15        2024             57   FIRE DEPARTMENT          HOLMES     PAMELA\n16        2024             57   FIRE DEPARTMENT       TURNER JR V. SIMPSON\n17        2024             57   FIRE DEPARTMENT     FILACCHIONE       MARC\n18        2024             57   FIRE DEPARTMENT         HOFFMAN     JOSEPH\n19        2024             57   FIRE DEPARTMENT        POTASNIK     JOSEPH\n   mid_init agency_start_date work_location_borough title_description\n1         G        10/24/2022             MANHATTAN          CHAPLAIN\n2         J        03/27/2017             MANHATTAN          CHAPLAIN\n3         M        06/24/2019             MANHATTAN          CHAPLAIN\n4                  12/11/2017             MANHATTAN          CHAPLAIN\n5                  06/15/2015             MANHATTAN          CHAPLAIN\n6         J        06/02/2014             MANHATTAN          CHAPLAIN\n7         Y        09/08/2014             MANHATTAN          CHAPLAIN\n8         U        08/02/2021             MANHATTAN          CHAPLAIN\n9         E        03/27/2017             MANHATTAN          CHAPLAIN\n10        L        06/18/2001             MANHATTAN          CHAPLAIN\n11                 12/16/1966             MANHATTAN          CHAPLAIN\n12        J        10/13/1998             MANHATTAN          CHAPLAIN\n13        E        05/15/1996              BROOKLYN          CHAPLAIN\n14        J        12/20/2021              BROOKLYN          CHAPLAIN\n15        D        09/25/2023              BROOKLYN          CHAPLAIN\n16                 11/20/2013              BROOKLYN          CHAPLAIN\n17                 10/30/1995              BROOKLYN          CHAPLAIN\n18        M        11/19/2001              BROOKLYN          CHAPLAIN\n19                 06/25/1998              BROOKLYN          CHAPLAIN\n   leave_status_as_of_june_30 base_salary       pay_basis regular_hours\n1                      ACTIVE       28713 Prorated Annual       1040.00\n2                      ACTIVE       36132 Prorated Annual       1040.00\n3                      ACTIVE       70241       per Annum       1820.00\n4                      ACTIVE       36133 Prorated Annual       1040.00\n5                      ACTIVE       38613 Prorated Annual       1040.00\n6                      ACTIVE       39453 Prorated Annual       1037.15\n7                      ACTIVE       39453 Prorated Annual       1040.00\n8                      ACTIVE       33020 Prorated Annual       1040.00\n9                      ACTIVE       36132 Prorated Annual       1040.00\n10                     ACTIVE       76176       per Annum       2080.00\n11                     ACTIVE       81839       per Annum       2080.00\n12                     ACTIVE       81440       per Annum       2080.00\n13                     CEASED       32169 Prorated Annual        440.00\n14                     ACTIVE       28713 Prorated Annual       1040.00\n15                     ACTIVE       33118 Prorated Annual        760.00\n16                     ACTIVE       33020 Prorated Annual       1040.00\n17                     ACTIVE       33146 Prorated Annual       1040.00\n18                     ACTIVE       33093 Prorated Annual       1040.00\n19                     ACTIVE       33130 Prorated Annual       1040.00\n   regular_gross_paid ot_hours total_ot_paid total_other_pay agency_name_clean\n1            27727.30     0.00          0.00          631.00 POLICE DEPARTMENT\n2            34891.77     0.00        195.72          631.00 POLICE DEPARTMENT\n3            67828.94     0.00       1674.26          631.00 POLICE DEPARTMENT\n4            34892.81     4.00        460.61          631.00 POLICE DEPARTMENT\n5            37286.87    38.50       1382.44          631.00 POLICE DEPARTMENT\n6            35795.97   234.00       8489.87          631.00 POLICE DEPARTMENT\n7            38098.41   393.25      15452.32          631.00 POLICE DEPARTMENT\n8            31694.66    89.00       3328.63         1131.00 POLICE DEPARTMENT\n9            34891.77   184.50       6656.21         1131.00 POLICE DEPARTMENT\n10           73537.28     0.00          0.00         6173.67 POLICE DEPARTMENT\n11           79005.61     0.00          0.00         7672.90 POLICE DEPARTMENT\n12           78620.77     0.00          0.00         8172.90 POLICE DEPARTMENT\n13           13538.74     0.00          0.00         1745.04   FIRE DEPARTMENT\n14           27727.30    49.00       1308.41         1971.99   FIRE DEPARTMENT\n15           23368.10    34.00       1047.12         2102.20   FIRE DEPARTMENT\n16           31885.88    99.50       3216.94         3883.34   FIRE DEPARTMENT\n17           31996.39    35.00       1188.79         5963.17   FIRE DEPARTMENT\n18           31944.64    13.00        440.90         6306.18   FIRE DEPARTMENT\n19           31980.53     0.00          0.00         6640.37   FIRE DEPARTMENT\n   total_pay agency_start_date_clean\n1   28358.30              2022-10-24\n2   35718.49              2017-03-27\n3   70134.20              2019-06-24\n4   35984.42              2017-12-11\n5   39300.31              2015-06-15\n6   44916.84              2014-06-02\n7   54181.73              2014-09-08\n8   36154.29              2021-08-02\n9   42678.98              2017-03-27\n10  79710.95              2001-06-18\n11  86678.51              1966-12-16\n12  86793.67              1998-10-13\n13  15283.78              1996-05-15\n14  31007.70              2021-12-20\n15  26517.42              2023-09-25\n16  38986.16              2013-11-20\n17  39148.35              1995-10-30\n18  38691.72              2001-11-19\n19  38620.90              1998-06-25\n\n\nCode\n  # filter(pay_basis == \"Prorated Annual\") \n\n\nremove pro_rated data “Prorated Annual”\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year &gt; \"2014\") |&gt;\n  group_by(agency_name_clean,fiscal_year) |&gt; \n  summarise(\n    Total_records = n(),\n    TOTAL_total_pay = sum(total_pay),\n    TOTAL_regular_gross_paid = sum(regular_gross_paid),\n    TOTAL_total_ot_paid = sum(total_ot_paid),\n    TOTAL_total_other_pay = sum(total_other_pay),\n    PCT_total_pay = sum(total_pay) / sum(total_pay),\n    PCT_regular_gross_paid = sum(regular_gross_paid)/ sum(total_pay),\n    PCT_total_ot_paid = sum(total_ot_paid)/ sum(total_pay),\n    PCT_total_other_pay = sum(total_other_pay)/ sum(total_pay),\n    records_with_1 = sum(is.na(regular_gross_paid)),\n    records_with_2 = sum(is.na(total_ot_paid)),\n    records_with_3 = sum(is.na(total_other_pay)),\n  ) |&gt; \n  arrange(agency_name_clean,fiscal_year,desc(Total_records))\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 20 × 14\n# Groups:   agency_name_clean [2]\n   agency_name_clean fiscal_year Total_records TOTAL_total_pay\n   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt;           &lt;dbl&gt;\n 1 FIRE DEPARTMENT          2015         17380     1634326504.\n 2 FIRE DEPARTMENT          2016         19934     1880395463.\n 3 FIRE DEPARTMENT          2017         18687     1802155816.\n 4 FIRE DEPARTMENT          2018         18391     1831077303.\n 5 FIRE DEPARTMENT          2019         18679     1785188573.\n 6 FIRE DEPARTMENT          2020         19193     1864413346.\n 7 FIRE DEPARTMENT          2021         19049     1932962516.\n 8 FIRE DEPARTMENT          2022         20920     2375560620.\n 9 FIRE DEPARTMENT          2023         19072     2204518077.\n10 FIRE DEPARTMENT          2024         21412     2625379035.\n11 POLICE DEPARTMENT        2015         59264     4595729044.\n12 POLICE DEPARTMENT        2016         65868     4852944949.\n13 POLICE DEPARTMENT        2017         62516     5317984531.\n14 POLICE DEPARTMENT        2018         59811     5044058215.\n15 POLICE DEPARTMENT        2019         59970     5162359791.\n16 POLICE DEPARTMENT        2020         60316     5356858768.\n17 POLICE DEPARTMENT        2021         59009     4914698674.\n18 POLICE DEPARTMENT        2022         60804     5340976504.\n19 POLICE DEPARTMENT        2023         58617     5227427707.\n20 POLICE DEPARTMENT        2024         65901     7246753318.\n# ℹ 10 more variables: TOTAL_regular_gross_paid &lt;dbl&gt;,\n#   TOTAL_total_ot_paid &lt;dbl&gt;, TOTAL_total_other_pay &lt;dbl&gt;,\n#   PCT_total_pay &lt;dbl&gt;, PCT_regular_gross_paid &lt;dbl&gt;, PCT_total_ot_paid &lt;dbl&gt;,\n#   PCT_total_other_pay &lt;dbl&gt;, records_with_1 &lt;int&gt;, records_with_2 &lt;int&gt;,\n#   records_with_3 &lt;int&gt;\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  filter(fiscal_year &gt; \"2014\") |&gt;\n  group_by(agency_name_clean,fiscal_year) |&gt; \n  summarise(\n    Total_records = n(),\n    TOTAL_total_pay = n_distinct(title_description)\n  ) |&gt; \n  arrange(agency_name_clean,fiscal_year,desc(Total_records))\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 20 × 4\n# Groups:   agency_name_clean [2]\n   agency_name_clean fiscal_year Total_records TOTAL_total_pay\n   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt;           &lt;int&gt;\n 1 FIRE DEPARTMENT          2015         17380             171\n 2 FIRE DEPARTMENT          2016         19934             171\n 3 FIRE DEPARTMENT          2017         18687             173\n 4 FIRE DEPARTMENT          2018         18391             174\n 5 FIRE DEPARTMENT          2019         18679             178\n 6 FIRE DEPARTMENT          2020         19193             178\n 7 FIRE DEPARTMENT          2021         19049             175\n 8 FIRE DEPARTMENT          2022         20920             183\n 9 FIRE DEPARTMENT          2023         19072             183\n10 FIRE DEPARTMENT          2024         21412             185\n11 POLICE DEPARTMENT        2015         59264             239\n12 POLICE DEPARTMENT        2016         65868             245\n13 POLICE DEPARTMENT        2017         62516             245\n14 POLICE DEPARTMENT        2018         59811             247\n15 POLICE DEPARTMENT        2019         59970             248\n16 POLICE DEPARTMENT        2020         60316             244\n17 POLICE DEPARTMENT        2021         59009             247\n18 POLICE DEPARTMENT        2022         60804             259\n19 POLICE DEPARTMENT        2023         58617             261\n20 POLICE DEPARTMENT        2024         65901             255\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  mutate(year_agency_start_date_clean = year(agency_start_date_clean)) |&gt; \n  filter(year_agency_start_date_clean == \"2024\") |&gt;\n  filter(fiscal_year &gt; \"2014\") |&gt;\n  group_by(agency_name_clean,title_description) |&gt; \n  summarise(\n    Total_records = n()\n    ,mean(base_salary)\n  ) |&gt; \n  arrange(agency_name_clean,desc(Total_records))\n\n\n`summarise()` has grouped output by 'agency_name_clean'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 46 × 4\n# Groups:   agency_name_clean [2]\n   agency_name_clean title_description         Total_records `mean(base_salary)`\n   &lt;chr&gt;             &lt;chr&gt;                             &lt;int&gt;               &lt;dbl&gt;\n 1 FIRE DEPARTMENT   FIREFIGHTER                         266              54122 \n 2 FIRE DEPARTMENT   EMERGENCY MEDICAL SPECIA…           221              39430.\n 3 FIRE DEPARTMENT   EMERGENCY MEDICAL SPECIA…            91              36330 \n 4 FIRE DEPARTMENT   AGENCY ATTORNEY                       2             112938.\n 5 FIRE DEPARTMENT   EXECUTIVE AGENCY COUNSEL              2             140187 \n 6 FIRE DEPARTMENT   PROGRAM PRODUCER                      2              23511.\n 7 FIRE DEPARTMENT   STAFF ANALYST                         2              74698 \n 8 FIRE DEPARTMENT   ASSISTANT COMMISSIONER                1             202592 \n 9 FIRE DEPARTMENT   AUTO MECHANIC                         1                391.\n10 FIRE DEPARTMENT   CASE - MANAGEMENT NURSE               1             100750 \n# ℹ 36 more rows\n\n\n\n\nCode\npayroll_data_fire_police |&gt; \n  # mutate(year_agency_start_date_clean = year(agency_start_date_clean)) |&gt; \n  # filter(fiscal_year == \"2018\") |&gt;\n  filter(title_description %in%  c(\"FIREFIGHTER\",\"POLICE OFFICER\")) |&gt;\n  group_by(agency_name_clean,pay_basis,fiscal_year,title_description) |&gt; \n  summarise(\n    Total_records = n()\n    ,mean(base_salary)\n    ,mean(total_pay)\n  ) |&gt; \n  arrange(agency_name_clean,desc(Total_records))\n\n\n`summarise()` has grouped output by 'agency_name_clean', 'pay_basis',\n'fiscal_year'. You can override using the `.groups` argument.\n\n\n# A tibble: 21 × 7\n# Groups:   agency_name_clean, pay_basis, fiscal_year [21]\n   agency_name_clean pay_basis fiscal_year title_description Total_records\n   &lt;chr&gt;             &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;                     &lt;int&gt;\n 1 FIRE DEPARTMENT   per Annum        2016 FIREFIGHTER               10484\n 2 FIRE DEPARTMENT   per Annum        2024 FIREFIGHTER                9804\n 3 FIRE DEPARTMENT   per Annum        2022 FIREFIGHTER                9690\n 4 FIRE DEPARTMENT   per Annum        2020 FIREFIGHTER                9085\n 5 FIRE DEPARTMENT   per Annum        2019 FIREFIGHTER                8902\n 6 FIRE DEPARTMENT   per Annum        2018 FIREFIGHTER                8899\n 7 FIRE DEPARTMENT   per Annum        2023 FIREFIGHTER                8773\n 8 FIRE DEPARTMENT   per Annum        2017 FIREFIGHTER                8739\n 9 FIRE DEPARTMENT   per Annum        2021 FIREFIGHTER                8479\n10 FIRE DEPARTMENT   per Annum        2015 FIREFIGHTER                8049\n# ℹ 11 more rows\n# ℹ 2 more variables: `mean(base_salary)` &lt;dbl&gt;, `mean(total_pay)` &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "",
    "text": "To access the data, we can go directly to the URL:\n\n\n\nThe file will be downloaded with the name: Citywide_Payroll_Data__Fiscal_Year__YYYYMMDD.csv",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#deciding-on-final-data-selection",
    "href": "data.html#deciding-on-final-data-selection",
    "title": "2  Data",
    "section": "2.3 Deciding on final data selection",
    "text": "2.3 Deciding on final data selection\nhere is a decision",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#deciding-on-final-data-subset",
    "href": "data.html#deciding-on-final-data-subset",
    "title": "2  Data",
    "section": "2.5 Deciding on final data subset",
    "text": "2.5 Deciding on final data subset\nBased on the analysis above, we will add a few filter to reduce and clean the dataset.\nFilters applied to the dataset:\n\n\n\n\n\n\nColumn Name\nFilter\n\n\n\n\nFiscal Year\nFrom 2015 to 2024\n\n\nAgency Name\nFIRE DEPARTMENT, POLICE DEPARTMENT\n\n\nPay Basis\nper Annum, per Day, per Hour\n\n\n\n\n\n\n\n\n\n\nCleaning data and Handling NAs:\n\n\n\n\n\n\nColumn Name\nNote\n\n\n\n\nFiscal Year\n2014 had missing data for Police Department. 2014 will be removed.\n\n\nAgency Name\nGroup agencies with similar names.\n\n\nPayroll Number\nMissing values have been backfilled based on Agency Name.\n\n\nWork Location Borough\nUppercase all names. Filtering data only for top 5 Boroughs.\n\n\nPay Basis\nKeeping only the top 3 Pay Basis.\n\n\n\n\n\n\n\n\n\n\nSize of Final subset Data\n\n\n\n\n\n\nDimensions\n804,630 rows and 17 columns\n\n\nEach row represents\nCity Employee Salary per Fiscal Year\n\n\n\n\n\n\n\nRecord count by Agency:\n\n\n\nCode\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(dplyr)\n\npayroll_data_fire_police |&gt; \n  group_by(agency_name) |&gt; \n  summarise(\n    Count = n()\n    , .groups = 'drop'\n  ) |&gt; \n  arrange(desc(Count)) |&gt;\n  mutate(Percentage = Count / sum(Count) * 100,\n         Label = paste(\n                       format(Count, big.mark = \",\"), \"\\n\", \" (\", sprintf(\"%.0f\", Percentage), \"%)\", sep = \"\")) |&gt; \nggplot(aes(x = \"\", y = Count, fill = agency_name)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(theta = \"y\") +\n  scale_fill_manual(name= 'Agency', values = c(\"#f94144\", \"deepskyblue3\")) +\n  # labs(title = \"Record Count by Department\") +\n  theme_void() +\n  geom_text(aes(label = Label), position = position_stack(vjust = 0.5), color = \"white\")\n\n\n\n\n\n\n\n\n\nOverall dataset Information:\n\n\n\n\n\n\n\n\n\n\n\nMetrics\nFire Deparmtnet\nPolice Department\n\n\n\n\nCount of Records\n192,638\n611,992\n\n\nFiscal Years\n10 years (2015-2024)\n10 years (2015-2024)\n\n\nAgency Start Date Range\n1968-04-22 to 2024-07-29\n1960-11-14 to 2049-10-16\n\n\nWork Location Borough\n5\n5\n\n\nTitle Description\n238\n335\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nInstruction\n2 Data data.qmd\n2.1 Technical description\nIdentify one or more data sources (see II. D. above) that you propose to draw on for the project. For each, describe how the data are collected and by whom. Describe the format of the data, the frequency of updates, dimensions, and any other relevant information. Note any issues / problems with the data, either known or that you discover. Explain how you plan to import the data. Carefully document your sources with links to the precise data sources that you used. If that is not possible (for example if your data is not available online, then explain that clearly.)\n(suggested: 1/2 page) 250-500 words\n2.2 Missing value analysis\nDescribe any patterns you discover in missing values. If no values are missing, graphs should still be included showing that.\n(suggested: 2 graphs plus commentary)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#understanding-the-raw-data",
    "href": "data.html#understanding-the-raw-data",
    "title": "2  Data",
    "section": "2.3 Understanding the raw data",
    "text": "2.3 Understanding the raw data\nNote any issues / problems with the data, either known or that you discover.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#understanding-and-cleaning-the-raw-data",
    "href": "data.html#understanding-and-cleaning-the-raw-data",
    "title": "2  Data",
    "section": "2.3 Understanding and cleaning the raw data",
    "text": "2.3 Understanding and cleaning the raw data\n\n\nCode\npayroll_data |&gt; \n  summarise(\n    \"Number of Agencies\"     = n_distinct(agency_name),\n    \"Number of Titles\"       = n_distinct(title_description),\n    \"Number of Locations\"    = n_distinct(work_location_borough),\n    \"Number of Pay Basis\"    = n_distinct(pay_basis),\n    \"Number of Fiscal Years\" = n_distinct(fiscal_year)\n  ) |&gt; \n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\nNumber of Agencies\nNumber of Titles\nNumber of Locations\nNumber of Pay Basis\nNumber of Fiscal Years\n\n\n\n\n170\n1991\n23\n4\n11\n\n\n\n\n\n\n2.3.1 Agencies\nMany of the agencies in the raw data have the following format: AGENCY_NAME #NUMBER.\nExamples:\n\n\n\nBROOKLYN COMMUNITY BOARD #1\nBROOKLYN COMMUNITY BOARD #2\nBROOKLYN COMMUNITY BOARD #3\n\n\nWe will group Agency names by aggregating all agencies that have the same name, but different numbers. This will reduce overall number os agencies.\n\n\nCode\npayroll_data &lt;- \n  payroll_data |&gt; \n  mutate(agency_name_clean = trimws(gsub(\"#\\\\d+$\", \"\", agency_name)))\n\npayroll_data |&gt; \n  summarise(\n    \"Number of Agencies Before\" = n_distinct(agency_name),\n    \"Number of Agencies After\"  = n_distinct(agency_name_clean),\n  ) |&gt; \n  kable()\n\n\n\n\n\nNumber of Agencies Before\nNumber of Agencies After\n\n\n\n\n170\n116\n\n\n\n\n\n\n\n\nNow, let’s take a look at the top 10 Agencies:\n\n\nCode\npayroll_data_summary &lt;- payroll_data |&gt; \n  group_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(desc(Total_records)) |&gt; \n  slice_head(n = 10)  \n\n\npayroll_data_summary |&gt; \n  kable(col.names = c(\"Agency\", \"Total Records\")) |&gt; \n  row_spec(which(payroll_data_summary$agency_name_clean == \"FIRE DEPARTMENT\"),   background = \"#f94144\", color = \"white\") |&gt; \n  row_spec(which(payroll_data_summary$agency_name_clean == \"POLICE DEPARTMENT\"), background = \"deepskyblue3\", color = \"white\")\n\n\n\n\n\nAgency\nTotal Records\n\n\n\n\nDEPT OF ED PEDAGOGICAL\n1207427\n\n\nDEPT OF ED PER SESSION TEACHER\n997983\n\n\nPOLICE DEPARTMENT\n612076\n\n\nDEPT OF ED PARA PROFESSIONALS\n412698\n\n\nBOARD OF ELECTION POLL WORKERS\n375001\n\n\nDEPT OF ED HRLY SUPPORT STAFF\n255501\n\n\nFIRE DEPARTMENT\n209272\n\n\nDEPARTMENT OF EDUCATION ADMIN\n181282\n\n\nDEPT OF PARKS & RECREATION\n170200\n\n\nHRA/DEPT OF SOCIAL SERVICES\n157963\n\n\n\n\n\n\n\n\n\n2.3.2 Work Location Borough\nWhen looking at the Work Location Borough, we see many recording with missing data (506,234 rows). We can also observe that the names of the locations are not standardized, some names are Uppercase and some are not (MANHATTAN vs Manhattan).\n\n\nCode\npayroll_data |&gt; \n  group_by(work_location_borough) |&gt; \n  summarise(\n    Total_records = n()\n  ) |&gt; \n  arrange(desc(Total_records)) |&gt; \n  slice_head(n = 10) |&gt; \n  kable(col.names = c(\"Locations\", \"Total Records\")) |&gt; \n  row_spec(which(payroll_data |&gt; \n                 group_by(work_location_borough) |&gt; \n                 summarise(Total_records = n()) |&gt; \n                 arrange(desc(Total_records)) |&gt; \n                 slice_head(n = 10) |&gt; \n                 pull(work_location_borough) %in% c(\"\",\"Bronx\", \"MANHATTAN\", \"Manhattan\")),   background = \"#fcefb4\", color = \"black\")\n\n\n\n\n\nLocations\nTotal Records\n\n\n\n\nMANHATTAN\n4077947\n\n\nQUEENS\n621225\n\n\nBROOKLYN\n523572\n\n\n\n506234\n\n\nBRONX\n286551\n\n\nOTHER\n116918\n\n\nRICHMOND\n77020\n\n\nWESTCHESTER\n5653\n\n\nULSTER\n3245\n\n\nManhattan\n1622\n\n\n\n\n\n\n\n\n\n\nOur first step here is to capitalize all the location names.\n\n\nCode\npayroll_data &lt;- payroll_data |&gt; \n  mutate(work_location_borough_clean = toupper(work_location_borough))\n\n\n\n\nCode\npayroll_data |&gt; \n  summarise(\n    \"Number of Locations Before\" = n_distinct(work_location_borough),\n    \"Number of Locations After\"  = n_distinct(work_location_borough_clean),\n  ) |&gt; \n  kable()\n\n\n\n\n\nNumber of Locations Before\nNumber of Locations After\n\n\n\n\n23\n19\n\n\n\n\n\n\n\n\nNow let’s take a look at the locations from the top 10 Agencies.\n\n\nCode\nrequired_boroughs &lt;- c(\"BRONX\", \"BROOKLYN\", \"MANHATTAN\", \"QUEENS\", \"RICHMOND\")\n\nagencies_present_in_required_boroughs &lt;-\n  payroll_data |&gt;\n  filter(work_location_borough_clean %in% required_boroughs) |&gt; \n  group_by(agency_name_clean) |&gt;  \n  summarise(\n    borough_count = n_distinct(work_location_borough_clean)  \n  ) |&gt;\n  filter(borough_count == length(required_boroughs)) |&gt; \n  filter(agency_name_clean %in% payroll_data_summary$agency_name_clean) |&gt; \n  pull(agency_name_clean)\n\n\n\n\nCode\npayroll_data_agencies_present_in_required_boroughs &lt;-\n  payroll_data |&gt; \n  filter(agency_name_clean %in% payroll_data_summary$agency_name_clean) |&gt; \n  filter(agency_name_clean %in% agencies_present_in_required_boroughs) |&gt; \n  group_by(agency_name_clean) |&gt; \n  summarise(\n    Total_records = n(),\n    \"Number of Locations\" = n_distinct(work_location_borough_clean)\n  ) |&gt; \n  arrange(desc(Total_records)) \n\npayroll_data_agencies_present_in_required_boroughs |&gt; \n  kable(col.names = c(\"Agency\", \"Total Records\", \"Number of Locations\")) |&gt; \n  row_spec(which(payroll_data_agencies_present_in_required_boroughs$agency_name_clean == \"FIRE DEPARTMENT\"),   background = \"#f94144\", color = \"white\") |&gt; \n  row_spec(which(payroll_data_agencies_present_in_required_boroughs$agency_name_clean == \"POLICE DEPARTMENT\"), background = \"deepskyblue3\", color = \"white\")\n\n\n\n\n\nAgency\nTotal Records\nNumber of Locations\n\n\n\n\nPOLICE DEPARTMENT\n612076\n5\n\n\nFIRE DEPARTMENT\n209272\n7\n\n\nDEPARTMENT OF EDUCATION ADMIN\n181282\n12\n\n\nDEPT OF PARKS & RECREATION\n170200\n7\n\n\nHRA/DEPT OF SOCIAL SERVICES\n157963\n8\n\n\n\n\n\n\n\n\n\nCode\npayroll_data |&gt; \n  filter(agency_name_clean %in%  c(\"POLICE DEPARTMENT\",\"FIRE DEPARTMENT\")) |&gt; \n  filter(agency_name_clean %in% agencies_present_in_required_boroughs) |&gt; \n  group_by(agency_name_clean,work_location_borough_clean,fiscal_year) |&gt; \n  summarise(\n    Total_records = n(), .groups = 'drop'\n  ) |&gt; \n  arrange(agency_name_clean,work_location_borough_clean,fiscal_year) |&gt; \n  filter (!work_location_borough_clean %in% required_boroughs) |&gt; \n  kable(col.names = c(\"Agency\", \"Location\", \"Fiscal Year\", \"Total Records\"))\n\n\n\n\n\nAgency\nLocation\nFiscal Year\nTotal Records\n\n\n\n\nFIRE DEPARTMENT\n\n2014\n16555\n\n\nFIRE DEPARTMENT\nOTHER\n2022\n1\n\n\n\n\n\n\n\n2.3.3 Fiscal Year\n\n\nCode\n# Create the pivot table\npivot_table_fiscal_year &lt;- payroll_data |&gt;\nfilter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \n  group_by(fiscal_year, agency_name_clean) |&gt; \n  summarise(count = n(), .groups = 'drop') |&gt; \n  pivot_wider(\n    names_from = agency_name_clean,  \n    values_from = count,  \n    values_fill = list(count = 0) \n  )\n\npivot_table_fiscal_year |&gt;\n  kable(col.names = c(\"Fiscal Year\", \"FIRE DEPARTMENT\", \"POLICE DEPARTMENT\")) |&gt; \n  kable_styling() |&gt;\n  column_spec(3, background = ifelse(as.matrix(pivot_table_fiscal_year[, 3]) == 0, \"#fcefb4\", \"\"))\n\n\n\n\n\nFiscal Year\nFIRE DEPARTMENT\nPOLICE DEPARTMENT\n\n\n\n\n2014\n16555\n0\n\n\n2015\n17380\n59264\n\n\n2016\n19934\n65868\n\n\n2017\n18687\n62516\n\n\n2018\n18391\n59811\n\n\n2019\n18679\n59970\n\n\n2020\n19193\n60316\n\n\n2021\n19049\n59009\n\n\n2022\n20920\n60804\n\n\n2023\n19072\n58617\n\n\n2024\n21412\n65901\n\n\n\n\n\n\n\n\n\n2.3.4 Pay Basis\n\n\nCode\npayroll_data |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \n  group_by(agency_name_clean,pay_basis) |&gt; \n  summarise(\n    Total_records = n(),\n    Count_of_titles = n_distinct(title_description)\n    , .groups = 'drop'\n  ) |&gt; \n  arrange(desc(Total_records)) |&gt;\n  kable(col.names = c(\"Agency\", \"Pay Basis\", \"Total Records\", \"Count of Titles\"))\n\n\n\n\n\nAgency\nPay Basis\nTotal Records\nCount of Titles\n\n\n\n\nPOLICE DEPARTMENT\nper Annum\n573429\n286\n\n\nFIRE DEPARTMENT\nper Annum\n203929\n199\n\n\nPOLICE DEPARTMENT\nper Hour\n32769\n29\n\n\nPOLICE DEPARTMENT\nper Day\n5794\n39\n\n\nFIRE DEPARTMENT\nper Day\n3934\n35\n\n\nFIRE DEPARTMENT\nper Hour\n1324\n47\n\n\nFIRE DEPARTMENT\nProrated Annual\n85\n1\n\n\nPOLICE DEPARTMENT\nProrated Annual\n84\n1\n\n\n\n\n\n\n\nCode\npayroll_data |&gt; \n  # filter(fiscal_year == \"2024\") |&gt;\n  filter(agency_name_clean %in%  c(\n    \"POLICE DEPARTMENT\",\n    \"FIRE DEPARTMENT\"\n    )) |&gt; \n  filter(pay_basis == \"Prorated Annual\") |&gt;\n  filter(title_description == \"CHAPLAIN\") |&gt; \n  group_by(agency_name_clean,pay_basis,title_description) |&gt; \n  summarise(\n    Total_records = n()\n    , .groups = 'drop'\n  ) |&gt; \n  arrange(agency_name_clean) |&gt;\n  kable(col.names = c(\"Agency\", \"Pay Basis\", \"Title\", \"Total Records\"))\n\n\n\n\n\nAgency\nPay Basis\nTitle\nTotal Records\n\n\n\n\nFIRE DEPARTMENT\nProrated Annual\nCHAPLAIN\n85\n\n\nPOLICE DEPARTMENT\nProrated Annual\nCHAPLAIN\n84\n\n\n\n\n\n\n\nCode\npayroll_data_filtered &lt;- \n  payroll_data |&gt; \n  filter(agency_name_clean %in%  c(\"POLICE DEPARTMENT\",\"FIRE DEPARTMENT\")) |&gt; \n  filter(work_location_borough_clean %in%   c(\"BRONX\", \"BROOKLYN\", \"MANHATTAN\", \"QUEENS\", \"RICHMOND\")) |&gt; \n  filter(fiscal_year &gt; \"2014\") |&gt; \n  filter(pay_basis %in%   c(\"per Annum\", \"per Day\", \"per Hour\"))\n\n\n\n\nCode\n# Count NA values and pivot\nna_summary &lt;- payroll_data_filtered |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"NA Count\"\n  )\n\n# Count blank values and pivot\nblank_summary &lt;- payroll_data_filtered |&gt;\n  summarise(across(everything(), ~ sum(. == \"\", na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Blank Count\"\n  )\n\n# Count zero values and pivot\nzero_summary &lt;- payroll_data_filtered |&gt;\n  summarise(across(everything(), ~ sum(. == 0, na.rm = TRUE))) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"Column\",\n    values_to = \"Zero Count\"\n  )\n\n# Combine all three summaries into one dataframe\ncombined_summary &lt;- na_summary |&gt;\n  inner_join(blank_summary, by = \"Column\") |&gt;\n  inner_join(zero_summary, by = \"Column\")\n\n# Display the combined result using kable\ncombined_summary |&gt;\n  filter(`NA Count` &gt; 0 | `Blank Count` &gt; 0 | `Zero Count` &gt; 0) |&gt; \n  kable(col.names = c(\"Column\", \"NA Count\", \"Blank Count\", \"Zero Count\"))\n\n\n\n\n\nColumn\nNA Count\nBlank Count\nZero Count\n\n\n\n\npayroll_number\n243601\n0\n0\n\n\nlast_name\n0\n9992\n0\n\n\nfirst_name\n0\n9992\n0\n\n\nmid_init\n0\n236244\n1\n\n\nregular_hours\n0\n0\n55220\n\n\nregular_gross_paid\n0\n0\n12285\n\n\not_hours\n0\n0\n168447\n\n\ntotal_ot_paid\n0\n0\n128243\n\n\ntotal_other_pay\n0\n0\n29997\n\n\n\n\n\n\n\n2.3.5 Payroll Number\n\n\nCode\npayroll_data_filtered_payroll &lt;- payroll_data_filtered |&gt; \n  group_by(agency_name_clean,payroll_number,fiscal_year) |&gt; \n  summarise(\n    Total_records = n()\n    ,.groups = \"drop\"\n  ) |&gt; \n  arrange(agency_name_clean,fiscal_year,desc(Total_records))\n\npayroll_data_filtered_payroll |&gt; \n  kable(col.names = c(\"Agency\", \"Payroll Number\", \"Fiscal Year\", \"Total Records\")) |&gt;\n  column_spec(2, background = ifelse(is.na(as.matrix(payroll_data_filtered_payroll[, 2])), \"#fcefb4\", \"\"))\n\n\n\n\n\nAgency\nPayroll Number\nFiscal Year\nTotal Records\n\n\n\n\nFIRE DEPARTMENT\nNA\n2015\n17372\n\n\nFIRE DEPARTMENT\nNA\n2016\n19926\n\n\nFIRE DEPARTMENT\nNA\n2017\n18679\n\n\nFIRE DEPARTMENT\n57\n2018\n18383\n\n\nFIRE DEPARTMENT\n57\n2019\n18671\n\n\nFIRE DEPARTMENT\n57\n2020\n19186\n\n\nFIRE DEPARTMENT\n57\n2021\n19042\n\n\nFIRE DEPARTMENT\n57\n2022\n20911\n\n\nFIRE DEPARTMENT\n57\n2023\n19063\n\n\nFIRE DEPARTMENT\n57\n2024\n21405\n\n\nPOLICE DEPARTMENT\nNA\n2015\n59257\n\n\nPOLICE DEPARTMENT\nNA\n2016\n65860\n\n\nPOLICE DEPARTMENT\nNA\n2017\n62507\n\n\nPOLICE DEPARTMENT\n56\n2018\n59802\n\n\nPOLICE DEPARTMENT\n56\n2019\n59961\n\n\nPOLICE DEPARTMENT\n56\n2020\n60308\n\n\nPOLICE DEPARTMENT\n56\n2021\n59001\n\n\nPOLICE DEPARTMENT\n56\n2022\n60795\n\n\nPOLICE DEPARTMENT\n56\n2023\n58608\n\n\nPOLICE DEPARTMENT\n56\n2024\n65893\n\n\n\n\n\n\n\n\n\nCode\npayroll_data_fire_police &lt;- \n  payroll_data_filtered |&gt;\n  mutate(\n    payroll_number = case_when(\n      is.na(payroll_number) & agency_name_clean == \"FIRE DEPARTMENT\" ~ 57,\n      is.na(payroll_number) & agency_name_clean == \"POLICE DEPARTMENT\" ~ 56,\n      TRUE ~ payroll_number\n    )\n  ) |&gt; \n  mutate(\n    agency_name = agency_name_clean,\n    work_location_borough = work_location_borough_clean\n  ) |&gt;\n  dplyr::select(-agency_name_clean, -work_location_borough_clean)\n\n\n\n\n2.3.6 Agency Start Date\n\n\nCode\nlibrary(lubridate)\n\npayroll_data_fire_police &lt;- \n  payroll_data_fire_police |&gt; \n  mutate(agency_start_date = mdy(agency_start_date))\n\n\nSave final Data:\n\n\n\nCode\n# CSV\n# write.csv(payroll_data_fire_police, \"data_source/payroll_data_fire_police.csv\", row.names = FALSE)\n\n# RDS\n# saveRDS(payroll_data_fire_police, \"data_source/payroll_data_fire_police.rds\")\n# payroll_data_fire_police &lt;- readRDS(\"data_source/payroll_data_fire_police.rds\")\n\n\nMissing value stuff goes here.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#understanding-and-cleaning-the-raw-data-1",
    "href": "data.html#understanding-and-cleaning-the-raw-data-1",
    "title": "2  Data",
    "section": "2.4 Understanding and cleaning the raw data",
    "text": "2.4 Understanding and cleaning the raw data\nNote any issues / problems with the data, either known or that you discover.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  }
]